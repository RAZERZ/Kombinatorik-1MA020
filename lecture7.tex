\documentclass{tufte-handout}

\title{Föreläsning 7: Dyck-stigar och Catalantal $\cdot$ 1MA020}

\author[Vilhelm Agdur]{Vilhelm Agdur\thanks{\href{mailto:vilhelm.agdur@math.uu.se}{\nolinkurl{vilhelm.agdur@math.uu.se}}}}

\date{14 februari 2023}


%\geometry{showframe} % display margins for debugging page layout

\usepackage{graphicx} % allow embedded images
  \setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}
  \graphicspath{{graphics/}} % set of paths to search for images
\usepackage{amsmath}  % extended mathematics
%\usepackage{booktabs} % book-quality tables
\usepackage{units}    % non-stacked fractions and better unit spacing
%\usepackage{multicol} % multiple column layout facilities
\usepackage{lipsum}   % filler text
\usepackage{fancyvrb} % extended verbatim environments
  \fvset{fontsize=\normalsize}% default font size for fancy-verbatim environments
\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{float}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{hyperref}
%\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{bbm}
\usepackage{mathrsfs}
\usetikzlibrary{automata, positioning, arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{calc}

\usepackage{color,soul} % Highlights for text

% Standardize command font styles and environments
\newcommand{\doccmd}[1]{\texttt{\textbackslash#1}}% command name -- adds backslash automatically
\newcommand{\docopt}[1]{\ensuremath{\langle}\textrm{\textit{#1}}\ensuremath{\rangle}}% optional command argument
\newcommand{\docarg}[1]{\textrm{\textit{#1}}}% (required) command argument
\newcommand{\docenv}[1]{\textsf{#1}}% environment name
\newcommand{\docpkg}[1]{\texttt{#1}}% package name
\newcommand{\doccls}[1]{\texttt{#1}}% document class name
\newcommand{\docclsopt}[1]{\texttt{#1}}% document class option name
\def\gring{\mathbb{G}}
\def\H{\mathbb{H}}
\def\ora{\overrightarrow}
\def\Lrarr{\Leftrightarrow}
\def\Ln#1{\text{Ln}\left(#1\right)}
\newenvironment{docspec}{\begin{quote}\noindent}{\end{quote}}% command specification environment

\include{mathcommands.extratex}

\begin{document}

\definecolor{darkgreen}{rgb}{0.0627, 0.4588, 0.1451}

\maketitle% this prints the handout title, author, and date

\begin{abstract}
\noindent
Vi introducerar Dyck-stigar, och härleder en rekursion för deras antal. Sedan använder vi rekursionen för att hitta en genererande funktion, och använder genererande funktionen för att ge en explicit formel för deras antal.

Efter det ger vi ett kombinatoriskt bevis för vår formel för antalet Dyck-stigar, som är betydligt kortare.

Slutligen ger vi två till exempel på saker som räknas av Catalantalen.
\end{abstract}

\section{Dyck-stigar}

\begin{definition}
    En \emph{gitterstig} på $\Z^2$ av längd $n$ mellan $a$ och $b$ börjar i punkten $a$ och tar sig sedan till punkten $b$ med $n$ stycken steg, som kan vara upp, ner, höger, eller vänster.\sidenote[][-0.3cm]{Vi kan betrakta en sådan stig som ett ord av längd $n$ ur alfabetet $\{U,N,H,V\}$, tillsammans med en startpunkt.}

    \begin{figure}
        \centering
        \begin{tikzpicture}
          \draw[step=.75cm] (0,0) grid (6cm,6cm);
          \draw[red, very thick] (0,0) -- (.75cm,0);
          \draw[red, very thick] (.75cm,0) -- (.75cm,.75cm);
          \draw[red, very thick] (.75cm,.75cm) -- (2*.75cm,.75cm);
          \draw[red, very thick] (2*.75cm,.75cm) -- (2*.75cm,0);
          \draw[red, very thick] (2*.75cm,0) -- (3*.75cm,0);
          \draw[red, very thick] (3*.75cm,0) -- (3*.75cm,.75cm);
          \draw[red, very thick] (3*.75cm,.75cm) -- (3*.75cm,2*.75cm);
          \draw[red, very thick] (3*.75cm,2*.75cm) -- (2*.75cm,2*.75cm);
          \draw[red, very thick] (2*.75cm,2*.75cm) -- (2*.75cm,4*.75cm);
          \draw[red, very thick] (2*.75cm,4*.75cm) -- (4*.75cm,4*.75cm);
          \draw[red, very thick] (4*.75cm,4*.75cm) -- (4*.75cm,5*.75cm);
          \draw[red, very thick] (4*.75cm,5*.75cm) -- (5*.75cm,5*.75cm);
          \draw[red, very thick] (5*.75cm,5*.75cm) -- (5*.75cm,2*.75cm);
          \draw[red, very thick] (5*.75cm,2*.75cm) -- (4*.75cm,2*.75cm);
          \draw[red, very thick] (4*.75cm,2*.75cm) -- (4*.75cm,3*.75cm);
          \draw[red, very thick] (4*.75cm,3*.75cm) -- (3*.75cm,3*.75cm);
          \draw[red, very thick] (3*.75cm,3*.75cm) -- (3*.75cm,7*.75cm);
          \draw[red, very thick] (3*.75cm,7*.75cm) -- (2*.75cm,7*.75cm);
          \draw[red, very thick] (2*.75cm,7*.75cm) -- (2*.75cm,8*.75cm);
        \end{tikzpicture}
        \caption{En gitterstig av längd $28$ från $(0,0)$ till $(2,8)$.}
    \end{figure} 
\end{definition}


Det finns uppenbarligen $4^n$ gitterstigar av längd $n$ med en given startpunkt, om vi inte kräver att den skall sluta i någon given punkt.

\begin{definition}
    En \emph{uppåt-höger-stig} på $\Z^2$ från $a$ till $b$ är en gitterstig mellan $a$ och $b$ som enbart tar steg uppåt och åt höger.\sidenote[][]{I tolkningen av stigar som ord är alltså dessa ord ur det mindre alfabetet $\{U,H\}$.}
\end{definition}
\begin{figure}[hbt!]
    \centering
    \begin{tikzpicture}
      \draw[step=.75cm] (0,0) grid (6cm,6cm);
      \draw[red, very thick] (0,0) -- (2*.75cm,0);
      \draw[red, very thick] (2*.75cm,0) -- (2*.75cm,2*.75cm);
      \draw[red, very thick] (2*.75cm,2*.75cm) -- (4*.75cm,2*.75cm);
      \draw[red, very thick] (4*.75cm,2*.75cm) -- (4*.75cm,3*.75cm);
      \draw[red, very thick] (4*.75cm,3*.75cm) -- (5*.75cm,3*.75cm);
      \draw[red, very thick] (5*.75cm,3*.75cm) -- (5*.75cm,6*.75cm);
      \draw[red, very thick] (5*.75cm,6*.75cm) -- (6*.75cm,6*.75cm);
      \draw[red, very thick] (6*.75cm,6*.75cm) -- (6*.75cm,7*.75cm);
      \draw[red, very thick] (6*.75cm,7*.75cm) -- (7*.75cm,7*.75cm);
      \draw[red, very thick] (7*.75cm,7*.75cm) -- (7*.75cm,8*.75cm);
      \draw[red, very thick] (7*.75cm,8*.75cm) -- (8*.75cm,8*.75cm);
    \end{tikzpicture}
    \caption{En uppåt-höger-stig från $(0,0)$ till $(8,8)$ av längd sexton.}
\end{figure}

Notera att till skillnad från allmänna gitterstigar bestäms en uppåt-höger-stigs längd av dess start och slutpunkt, eftersom den inte kan ta några omvägar eller gå baklänges. En stig från $(0,0)$ till $(a,b)$ kommer alltid att ta precis $a$ steg uppåt och $b$ steg till höger, det enda som kan variera är i vilken ording stegen tas.

Alltså ges det totala antalet uppåt-höger-stigar från $(0,0)$ till $(a,b)$ av $\binom{a+b}{a}$, eftersom det är antalet sätt att välja de $a$ ställen vi tar ett steg höger av totalt $a+b$ steg.

\begin{definition}
    En Dyck-stig av längd $2n$ är en uppåt-höger-stig från $(0,0)$ till $(n,n)$ som aldrig går under diagonalen.\par
\end{definition}
\begin{figure}[hbt!]
    \centering
    \begin{tikzpicture}
      \draw[step=.75cm] (0,0) grid (6cm,6cm);
      \draw[blue, very thick] (0,0) -- (6cm,6cm);
      \draw[red, very thick] (0,0) -- (0,2*.75cm);
      \draw[red, very thick] (0,2*.75cm) -- (1*.75cm,2*.75cm);
      \draw[red, very thick] (1*.75cm,2*.75cm) -- (1*.75cm,4*.75cm);
      \draw[red, very thick] (1*.75cm,4*.75cm) -- (4*.75cm,4*.75cm);
      \draw[red, very thick] (4*.75cm,4*.75cm) -- (4*.75cm,5*.75cm);
      \draw[red, very thick] (4*.75cm,5*.75cm) -- (5*.75cm,5*.75cm);
      \draw[red, very thick] (5*.75cm,5*.75cm) -- (5*.75cm,7*.75cm);
      \draw[red, very thick] (5*.75cm,7*.75cm) -- (6*.75cm,7*.75cm);
      \draw[red, very thick] (6*.75cm,7*.75cm) -- (6*.75cm,8*.75cm);
      \draw[red, very thick] (6*.75cm,8*.75cm) -- (8*.75cm,8*.75cm);
    \end{tikzpicture}
    \caption{En Dyck-stig av längd sexton.}
\end{figure}

Notera att en Dyck-stig alltid måste börja med ett steg uppåt och sluta med ett steg åt höger, eftersom den annars ju hade varit under diagonalen.\par
\vspace{.2cm}
 Om vi roterar figuren 45 grader medurs noterar vi att vi får något som ser ut som bergskedjor. Detta är ett vanligt sätt att se Dyck-stigar.\par
\vspace{.2cm}
 \begin{figure}[hbt!]
    \centering
    \begin{tikzpicture}[rotate=-45]
      \draw[step=.75cm] (0,0) grid (6cm,6cm);
      \draw[blue, very thick] (0,0) -- (6cm,6cm);
      \draw[red, very thick] (0,0) -- (0,2*.75cm);
      \draw[red, very thick] (0,2*.75cm) -- (1*.75cm,2*.75cm);
      \draw[red, very thick] (1*.75cm,2*.75cm) -- (1*.75cm,4*.75cm);
      \draw[red, very thick] (1*.75cm,4*.75cm) -- (4*.75cm,4*.75cm);
      \draw[red, very thick] (4*.75cm,4*.75cm) -- (4*.75cm,5*.75cm);
      \draw[red, very thick] (4*.75cm,5*.75cm) -- (5*.75cm,5*.75cm);
      \draw[red, very thick] (5*.75cm,5*.75cm) -- (5*.75cm,7*.75cm);
      \draw[red, very thick] (5*.75cm,7*.75cm) -- (6*.75cm,7*.75cm);
      \draw[red, very thick] (6*.75cm,7*.75cm) -- (6*.75cm,8*.75cm);
      \draw[red, very thick] (6*.75cm,8*.75cm) -- (8*.75cm,8*.75cm);
    \end{tikzpicture}
    \caption{Roterad Dyck-stig ser ut som bergskedjor.\par\noindent Denna skulle ha sträng $uuduuddduduududd$.}
  \end{figure}\par
  \vspace{.2cm}
 Ett användbart trick att använda sig av är att uppåt-höger-stigar (eller uppåt-neråt, om man tittar på bergskedjorna) kan översättas till strängar.\par
 \noindent Om vi låter $u$ signalera ``uppåt'' och $h$ signalera ``höger'', blir exempelvis Figur 3 följande:
 \begin{equation*}
   \begin{gathered}
     uuhuuhhhuhuuhuhh
   \end{gathered}
 \end{equation*}
  \par
  \vspace{.2cm}
Hur många Dyck-stigar finns det av varje given längd? Vi kan använda vår observation om att de alltid börjar med ett upp-steg för att ge en rekursion för detta antal:

\begin{lemma}\label{dyck_path_recursion_lemma}
    Låt $d_n$ beteckna antalet Dyck-stigar av längd $2n$. Då gäller det för alla $n \geq 0$ att
    $$d_{n+1} = \sum_{k=0}^{n} d_k d_{n-k}$$
    och $d_0 = 1$.\sidenote[][]{Antalet ord av längd noll anser vi vara ett, eftersom det bara finns ett sätt att välja ett sådant.}

    \begin{proof}
     Om vi låtsas vara stigen i punkten $(0,0)$ som ska gå till $(n,n)$ kanske vi kan klura ut vilka verktyg vi ska använda som vi lärt oss i kursen.\par
     \noindent I varje steg har vi 2 val, upp eller höger. Samtidigt beror vårat val på föregående val, eftersom vi måste hålla oss över diagonalen. Det låter rekursivt! Hittar vi ett rekursivt förhållande så har vi de kraftfulla verktygen \emph{genererande funktioner} som kan ge oss något mer konkret.\clearpage
     \begin{figure}[hbt!]
          \centering
          \begin{tikzpicture}
            \draw[step=.75cm] (0,0) grid (6cm,6cm);
            \draw[black,very thick,dashed] (0,0) -- (6cm,6cm);
            \draw[gray,very thick] (0,0) -- (0,.75cm);
            \draw[gray,thick,dashed] (0,.75cm) -- (2*.75cm, 3*.75cm);
            \draw[gray,very thick] (2*.75cm, 3*.75cm) -- (3*.75cm, 3*.75cm);
            \draw[blue, very thick] (0,.75cm) -- (0,2*.75cm);
            \draw[blue, very thick] (0,2*.75cm) -- (.75cm,2*.75cm);
            \draw[blue, very thick] (.75cm,2*.75cm) -- (.75cm,3*.75cm);
            \draw[blue, very thick] (.75cm,3*.75cm) -- (2*.75cm,3*.75cm);
            \draw[red, very thick] (3*.75cm,3*.75cm) -- (3*.75cm,5*.75cm);
            \draw[red, very thick] (3*.75cm,5*.75cm) -- (5*.75cm,5*.75cm);
            \draw[red, very thick] (5*.75cm,5*.75cm) -- (5*.75cm,7*.75cm);
            \draw[red, very thick] (5*.75cm,7*.75cm) -- (7*.75cm,7*.75cm);
            \draw[red, very thick] (7*.75cm,7*.75cm) -- (7*.75cm,8*.75cm);
            \draw[red, very thick] (7*.75cm,8*.75cm) -- (8*.75cm,8*.75cm);
          \end{tikzpicture}
          \caption{En illustration av vår uppdelning av en Dyck-stig i gråa, blåa, och röda steg.}
      \end{figure}
        Överväg en Dyck-stig av längd $2(n+1)$. Vi kan dela upp den i två kortare Dyck-stigar som följer: Den börjar med ett upp-steg, som vi färgar grått. Sedan fortsätter den i ett tag tills den träffar diagonalen för första gången. Vi färgar alla steg innan det steg i vilken den träffar diagonalen blåa, och steget i vilken den träffar diagonalen grått. Sedan färgar vi resten av stegen röda.

        Vi hävdar att de blå stegen utgör en Dyck-stig av längd $2k$ för något $0 \leq k \leq n$, och de röda stegen utgör en Dyck-stig av längd $2(n-k)$, så att vi tillsammans med de två gråa stegen har totalt $2k + 2(n-k) + 2 = 2(n+1)$ steg. Ekvivalent, i tolkningen av stigar som ord, så säger vi att ordet för stigen vi började med kan skrivas som
        $$\underbrace{U}_{\text{Start}}\overbrace{w_1}^{\text{Blå}}\underbrace{H}_{\text{Grå}}\overbrace{w_2}^{\text{Röd}}$$
        för två kortare\sidenote[][]{Det är tillåtet att de är av längd noll.} Dyck-stigar $w_1$ och $w_2$.

        Vi kan välja $k$ fritt mellan $0$ och $n$, och vi kan sedan välja våra två kortare Dyck-stigar helt fritt så länge de har rätt längd, så multiplikations- och additionsprincipen ger oss att vi kan totalt välja på
        $$\sum_{k=0}^{n} d_k d_{n-k}$$
        sätt, vilket är vad vi ville bevisa.
    \end{proof}
\end{lemma}

Den uppmärksamme bland er kanske redan känt igen att den här rekursionen säger något om en faltning -- specifikt säger den att
$$d_{n+1} = (d * d)_n,$$
vilket ser ut som något vi borde kunna använda för att räkna ut genererande funktionen av den här följden.

\begin{proposition}
    Den genererande funktionen för $\{d_k\}_{k=0}^\infty$, antalet Dyck-stigar, är
    $$F_d(x) = \frac{1 - \sqrt{1 - 4x}}{2x}.$$

    \begin{proof}
        Vi observerar att Lemma \ref{dyck_path_recursion_lemma} ger oss att för alla $n \geq 0$
        $$d_{n+1} = (d*d)_n,$$
        så om vi tar genererande funktioner av bägge sidorna ser vi att vänster led blir
        $$\sum_{n=0}^{\infty}d_{n+1}x^n = \frac{1}{x}\sum_{n=0}^{\infty} d_n x^{n+1} = \frac{F_d(x) - 1}{x}$$ %även fast n=0 ger 0, kan det vara pedagogiskt att behålla 0:te indexet
        och höger led blir
        $$F_{d * d}(x) = F_d(x)^2$$
        så att vi har att
        \begin{equation*}
          \begin{gathered}
            F_d(x)^2 = \dfrac{F_d(x)-1}{x}\\
            \Lrarr xF_d(x)^2 = F_d(x)-1\\
            \Lrarr F_d(x) = x F_d(x)^2 + 1.
          \end{gathered}
        \end{equation*}

        Det här är ju bara en vanlig andragradsekvation som vi kan lösa för $F_d$, och få att
        $$F_d(x) = \frac{1 \pm \sqrt{1 - 4x}}{2x}.$$

        Det enda som återstår är att se om den rätta lösningen har ett plus- eller minustecken. Sättet vi ser detta på är att vi vet vad den skall ta för värde i en specifik punkt -- vi vet nämligen att antalet stigar mellan $(0,0)$ och $(0,0)$ är 1
        $$F_d(0) = \sum_{k=0}^{\infty} d_k 0^k = d_0 = 1$$
        så funktionen måste vara ett i noll.

        Vi undersöker vad som händer i $+$ resp. $-$ fallen:
        $$\lim_{x \to 0} \frac{1 - \sqrt{1 - 4x}}{2x} = 1$$
        medan gränsvärdet
        $$\lim_{x \to 0} \frac{1 + \sqrt{1 - 4x}}{2x}$$
        inte existerar. Alltså måste den korrekta lösningen vara med minustecknet, såsom önskat.
    \end{proof}
\end{proposition}

Så, hittills har vi definierat våra Dyck-stigar, listat ut en rekursion för deras antal, och använt denna rekursion för att härleda en genererande funktion. Kan vi använda denna genererande funktion för att härleda en explicit formel för antalet Dyck-stigar?

Svaret på den frågan är ja, men det kräver ett lemma vi inte sett ännu.

\section{Newtons binomialsats, och en explicit formel för $d_n$}

\begin{definition}
    För varje $x\in \R$ och varje $k \in \Z^{\geq 0}$ ges den \emph{fallande fakulteten} $x^{\underline{k}}$ av\sidenote[][]{Så produkten har $k$ termer. I fallet med $k=0$ får vi en tom produkt, vilket vi konventionellt anser är ett, så $x^{\underline{0}} = x^{\overline{0}} = 1$ för alla $x$.}
    $$x^{\underline{k}} = x(x-1)(x-2)\ldots(x-k+1)$$
    och den \emph{stigande fakulteten} $x^{\overline{k}}$ av
    $$x^{\overline{k}} = x(x+1)(x+2)\ldots(x+k-1).$$

    Om $x$ är ett heltal ges alltså $x^{\underline{k}}$ av $\frac{x!}{(x-k)!}$ och $x^{\overline{k}}$ av $\frac{(x+k-1)!}{(x-1)!}$.\par
    \vspace{.2cm}
    Notera att $x^{\underline{k}} = (x-k+1)^{\overline{k}}$
\end{definition}

Vi kan särskilt notera att när $x$ är ett heltal ges antalet permutationer av längd $k$ ur ett alfabete med $x$ bokstäver alltså av $x^{\underline{k}}$, och således har vi också att
$$\binom{x}{k} = \frac{x^{\underline{k}}}{k!}$$
för alla heltal $x$ och $k$. Men detta uttrycket är ju helt väldefinierat även om $x$ inte är ett heltal, vilket motiverar oss att göra följande definition:

\begin{definition}
    För alla $x \in \R$ och $k \in \Z^{\geq 0}$ säger vi att
    $$\binom{x}{k} = \frac{x^{\underline{k}}}{k!}.$$
\end{definition}

Anledningen att vi gör allt detta arbetet är att det låter oss generalisera binomialsatsen även till potenser som inte är heltal, såsom Newton upptäckte.

\begin{theorem}[Newtons binomialsats]
    För alla $x$ och $y$ och $r \in \R$ gäller det att
    $$(x + y)^r = \sum_{k=0}^{\infty} \binom{x}{k} x^{r-k} y^k$$

    \begin{proof}
        Taylorutveckla.\sidenote[][]{Ett bevis återfinns lätt med google, men eftersom det inte egentligen har något med kombinatorik att göra utelämnar vi det i denna kursen.}
    \end{proof}
\end{theorem}

Låt oss nu tillämpa vår nya kunskap på Dyckstigarna. Eftersom den genererande funktionen vi fann för deras antal involverade en kvadratrot kommer vi ju vilja tillämpa Newtons binomialsats i fallet med $r = \frac{1}{2}$, så låt oss börja med ett lemma om vad som händer i just det fallet.

\begin{proposition}\label{ugly_dyck_path_formula}
    Antalet Dyck-stigar av längd $2n$, $d_n$, ges av
    $$d_n = 2 (-1)^{n+1}\binom{1/2}{n+1} 4^n.$$

    \begin{proof}
        Vi vet att den genererande funktionen för denna följd ges av
        $$F_d(x) = \sum_{k=0}^{\infty} d_k x^k = \frac{1 - \sqrt{1 - 4x}}{2x}$$
        så vi behöver serieutveckla detta uttryck.

        Newtons binomialsats säger oss att
        $$\sqrt{1 + y} = \sum_{k=0}^{\infty} \binom{1/2}{k} y^k$$
        så om vi sätter in $y = -4x$ får vi att
        $$\sqrt{1 - 4x} = \sum_{k=0}^{\infty} (-1)^k \binom{1/2}{k} 4^k x^k.$$
        
        När $k=0$ så blir $\binom{1/2}{0} = \frac{(1/2)^{\underline{0}}}{0!} = \frac{1}{1}$, och alltså är hela nollte termen lika med ett. Så alltså gäller det att
        \begin{align*}
            \frac{1 - \sqrt{1 - 4x}}{2x} &= \frac{\sum_{k=1}^{\infty} (-1)^k \binom{1/2}{k} 4^k x^k}{2x}\\
            &= \sum_{k=1}^{\infty} 2(-1)^k \binom{1/2}{k} 4^{k-1} x^{k-1}\\
            &= \sum_{k=0}^{\infty} 2 (-1)^{k+1}\binom{1/2}{k+1} 4^k x^k
        \end{align*}
        vilket genom att jämföra koefficienter ger oss resultatet.
    \end{proof}
\end{proposition}

Så vi har hittat \emph{en} formel, men den är inte särskilt vacker. Även om vi intellektuellt vet att den borde ge oss heltal är det inte alls uppenbart, med den fraktionella binomialkoefficienten och allt.

Kan vi hitta en vackrare formel? Svaret är ja, och det finns flera sätt för oss att göra det. Om vi hade haft mer uthållighet med krångliga räkningar hade vi kunna bevisa följande lemma, vilket låter oss förenkla uttrycket vi fick i Proposition \ref{ugly_dyck_path_formula}:

\begin{lemma}\label{lemma_onehalf_binom_coeff}
    Det gäller att
    $$\binom{1/2}{n} = \frac{(-1)^{n+1}}{4^n(2n-1)}\binom{2n}{n}.$$
    \begin{proof}
        Utelämnas. Om du verkligen vill se en räkning för detta finns det ett bevis för något snarlikt, som borde gå att förenkla till detta, på stackexchange.\cite{dyck_path_stackexchange}
    \end{proof}
\end{lemma}

När vi tagit detta Lemma \ref{lemma_onehalf_binom_coeff} och stoppat in det i Proposition \ref{ugly_dyck_path_formula} får vi följande mycket vackrare formel:

\begin{theorem}\label{theorem_dyck_paths_counted_by_catalan}
    Antalet Dyck-stigar $d_n$ ges av
    $$d_n = \frac{1}{n + 1}\binom{2n}{n} = \dfrac{(2n)!}{n!(n+1)!} = \prod_{k=2}^{n}\dfrac{n+k}{k}.$$

    I själva verket är dessa tal så viktiga att de har sitt egna namn -- de kallas för \emph{Catalan-talen}.
\end{theorem}

Så vi har till slut hittat en fin formel för antalet Dyck-stigar, och alltså för Catalantalen. Tyvärr var vägen vi tog dit väldigt lerig, i botten på en hopväxt och snårig dal. Finns det ett mindre kladdigt sätt att hitta denna formel?\sidenote[][]{Vårt arbete med att ta fram denna formel för antalet Dyck-stigar illustrerar både för- och nackdelarna med metoden med genererande funktioner. Det är en pålitlig metod, med tydliga steg för vad vi vill göra -- efter att vi hittade rekursionen vi började med behövde vi aldrig egentligen vara kreativa, utan vi kom fram till målet genom att bara följa vårt recept.

Å andra sidan kan räkningarna man behöver göra för att tillämpa metoden vara väldigt fula. Vad man köper i standardisering får man betala för i begriplighet -- det är nog svårt att säga att man begriper \emph{varför} den formeln ger Catalantalen efter att ha sett vårt bevis.}

\section{Ett kombinatoriskt bevis för formeln för Catalantalen}

\begin{proof}[Ett kombinatoriskt bevis av Teorem \ref{theorem_dyck_paths_counted_by_catalan}]
    Låt oss överväga samlingen av alla uppåt-höger-stigar från $(0,0)$ till $(n,n)$. Vi kallar varje stig som passerar under diagonalen för en \emph{dålig} stig -- mängden av sådana är uppenbarligen komplementet till mängden av Dyck-stigar. Så om vi kan räkna de dåliga stigarna får vi också antalet Dyck-stigar, eftersom vi vet att det totala antalet uppåt-höger-stigar från $(0,0)$ till $(n,n)$ är precis $\binom{2n}{n}$.

    Sättet vi räknar antalet dåliga stigar är att påvisa en bijektion mellan dem och mängden av uppåt-höger-stigar från $(0,0)$ till $(n+1,n-1)$.

    \begin{figure}\label{fig:dyck_comb_proof_path}
        \centering
        \begin{tikzpicture}[every plot/.style={mark=*, mark size=1.5mm, only marks}]
          \draw[step=6cm, thick] (0,0) grid (6cm,6cm);
          \draw[step=.75cm, gray] (0,0) grid (6cm,6cm);
          \draw[blue,thick] (0,0) -- (6cm,6cm);
          \draw[red,thick] (.75cm,0) -- (6cm, 7*.75cm);
          \draw[gray,ultra thick] (0,0) -- (0,2*.75cm);
          \draw[gray,ultra thick] (0,2*.75cm) -- (2*.75cm,2*.75cm);
          \draw[gray,ultra thick] (2*.75cm,2*.75cm) -- (2*.75cm,3*.75cm);
          \draw[gray,ultra thick] (2*.75cm,3*.75cm) -- (5*.75cm,3*.75cm);
          \draw[gray,ultra thick] (5*.75cm,3*.75cm) -- (5*.75cm,5*.75cm);
          \draw[gray,ultra thick] (5*.75cm,5*.75cm) -- (6*.75cm,5*.75cm);
          \draw[gray,ultra thick] (6*.75cm,5*.75cm) -- (6*.75cm,6*.75cm);
          \draw[gray,ultra thick] (6*.75cm,6*.75cm) -- (7*.75cm,6*.75cm);
          \draw[gray,ultra thick] (7*.75cm,6*.75cm) -- (7*.75cm,8*.75cm);
          \draw[gray,ultra thick] (7*.75cm,8*.75cm) -- (8*.75cm,8*.75cm);
          \draw plot coordinates{(4*.75cm,3*.75cm)};
        \end{tikzpicture}
        \caption{En av våra dåliga stigar, med huvuddiagonalen i blått och första diagonalen under huvuddiagonalen i rött. Punkten där stigen träffar den första underdiagonalen markeras med en cirkel.}
    \end{figure}

    Givet en dålig stig markerar vi första punkten på vilken den träffar första underdiagonalen, alltså diagonalen under huvuddiagonalen. Att det måste finnas en sådan punkt följer av att stigen är dålig -- om den aldrig träffade den underdiagonalen vore stigen en Dyckstig.

    Sedan speglar vi resten av stigen, efter punkten vi markerade, i första underdiagonalen. Vi ersätter alltså varje steg uppåt med ett steg till höger, och varje steg till höger med ett steg uppåt. 

    \begin{figure}\label{fig:dyck_comb_proof_reflected_path}
        \centering
        \begin{tikzpicture}[every plot/.style={mark=*, mark size=1.5mm, only marks}]
          \draw[step=6cm, thick] (0,0) grid (6cm,6cm);
          \draw[step=.75cm, gray] (0,0) grid (6.75cm,6cm);
          \draw[blue,thick] (0,0) -- (6cm,6cm);
          \draw[red,thick] (.75cm,0) -- (6cm, 7*.75cm);
          \draw[gray,ultra thick] (0,0) -- (0,2*.75cm);
          \draw[gray,ultra thick] (0,2*.75cm) -- (2*.75cm,2*.75cm);
          \draw[gray,ultra thick] (2*.75cm,2*.75cm) -- (2*.75cm,3*.75cm);
          \draw[gray,ultra thick] (2*.75cm,3*.75cm) -- (4*.75cm,3*.75cm);
          \draw[gray,thick] (2*.75cm,3*.75cm) -- (5*.75cm,3*.75cm);
          \draw[gray,thick] (5*.75cm,3*.75cm) -- (5*.75cm,5*.75cm);
          \draw[gray,thick] (5*.75cm,5*.75cm) -- (6*.75cm,5*.75cm);
          \draw[gray,thick] (6*.75cm,5*.75cm) -- (6*.75cm,6*.75cm);
          \draw[gray,thick] (6*.75cm,6*.75cm) -- (7*.75cm,6*.75cm);
          \draw[gray,thick] (7*.75cm,6*.75cm) -- (7*.75cm,8*.75cm);
          \draw[gray,thick] (7*.75cm,8*.75cm) -- (8*.75cm,8*.75cm);
          \draw[blue,very thick] (4*.75cm,3*.75cm) -- (4*.75cm,4*.75cm);
          \draw[blue,very thick] (4*.75cm,4*.75cm) -- (6*.75cm,4*.75cm);
          \draw[blue,very thick] (6*.75cm,4*.75cm) -- (6*.75cm,5*.75cm);
          \draw[blue,very thick] (6*.75cm,5*.75cm) -- (7*.75cm,5*.75cm);
          \draw[blue,very thick] (7*.75cm,5*.75cm) -- (7*.75cm,6*.75cm);
          \draw[blue,very thick] (7*.75cm,6*.75cm) -- (9*.75cm,6*.75cm);
          \draw[blue,very thick] (9*.75cm,6*.75cm) -- (9*.75cm,7*.75cm);
          \draw plot coordinates{(4*.75cm,3*.75cm)};
        \end{tikzpicture}
        \caption{Den uppåt-höger-stig från $(0,0)$ till $(n+1,n-1)$ som motsvarar vår dåliga stig i förra figuren. Stigen är grå fram tills punkten där vi började spegla den, och fortsätter sedan i blått. Originalstigen fortsätter i grått.}
    \end{figure}

    Eftersom vi i punkten vi började spegla just träffat första underdiagonalen så måste vi i den punkten ha haft ett steg mer åt höger än uppåt. Totalt har vi, i originalstigen, lika många steg uppåt som åt höger, så återstoden av den efter den punkten måste ha ett steg mer uppåt än åt höger.

    När vi speglar blir varje steg uppåt ett åt höger, och vice versa, så vår speglade stig måste ha ett steg mer åt höger än uppåt också i biten efter speglingen. Alltså måste den resulterande stigen efter speglingen ha två steg fler åt höger än uppåt, och alltså hamna i $(n+1,n-1)$.\sidenote[][-1cm]{I symboler har vi $u_i$ steg \emph{u}ppåt i stigen \emph{i}nnan punkten vi speglar efter, och $h_i$ steg åt \emph{h}öger. Efter punkten vi speglar \emph{e}fter har vi $u_e$ steg uppåt och $h_e$ steg åt höger. Så i Figur \ref{fig:dyck_comb_proof_path} så har vi $u_i = 3$, $h_i = 4$, $u_e = 5$, och $h_e = 4$.
    
    Så för stigen vi börjar med har vi $h_i = u_i + 1$, och $h_i + h_e = n$ samt $u_i + u_e = n$ för att den skall sluta i $(n,n)$. Stigen efter speglingen kommer att ha $h_i + u_e$ steg åt höger och $u_i + h_e$ steg uppåt. Om man arbetar sig igenom dessa ekvationer kommer man att se att vi verkligen har $n+1$ steg åt höger och $n-1$ steg uppåt i den reflekterade stigen.}

    Så vi har hittat ett sätt att skicka en dålig stig på en stig från $(0,0)$ till $(n+1,n-1)$. För att detta skall vara en bijektion måste processen vara reversibel - givet en stig från $(0,0)$ till $(n+1,n-1)$ måste vi kunna återskapa den motsvarande dåliga stigen.

    Sättet vi gör det på är samma som innan -- vi hittar första punkten i vilken vår stig träffar första underdiagonalen, och speglar efter den. Att en sådan punkt måste finnas är uppenbart, eftersom $(0,0)$ ligger ovanför den underdiagonalen, och $(n+1,n-1)$ ligger under den. Så för att ta oss från ena sidan av den till andra måste vi passera den.

    Att denna spegling kommer ge oss rätt dåliga stig är enkelt att se -- allt vi gjort är att spegla två gånger, vilket så klart inte gör någonting.

    Alltså har vi bevisat att antalet dåliga stigar är lika med antalet stigar från $(0,0)$ till $(n+1,n-1)$. Vi vet att det finns $\binom{(n + 1) + (n - 1)}{n+1}$ sådana stigar, så vi kan räkna att
    \begin{align*}
        d_n &= \abs{\text{stigar }(0,0)\to(n,n)} - \abs{\text{dåliga stigar}}\\
        &= \binom{2n}{n} - \binom{2n}{n+1}\\
        &= \frac{(2n)!}{n!n!} - \frac{(2n)!}{(n+1)!(n-1)!}\\
        &= (2n)!\left(\frac{(n+1)}{(n+1)!n!} - \frac{n}{(n+1)!n!}\right)\\
        &= \frac{(2n)!}{(n+1)!n!} = \frac{1}{n+1}\frac{(2n)!}{n!n!} = \frac{1}{n+1}\binom{2n}{n}
    \end{align*}
    vilket bevisar satsen.
\end{proof}

Så vårt kombinatoriska bevis undvek helt att behöva fundera på rekursioner och genererande funktioner. Det är en mycket mer direkt rutt till vårt mål, men vi missade några sevärdheter längs vägen.\sidenote[][]{Hur man hade härlett vår rekursion eller den genererande funktionen givet bara vad vi lärde oss i det kombinatoriska beviset är långt ifrån uppenbart.}


\subsection{Ekvivalenta kombinatoriska omskrivningar av Catalantalen}\hfill\\\par
Nu när vi väl har funnit en explicit formel för Catalantalen med hjälp av binomialtal, finns det fler sätt vi kan räkna de?\par
\noindent Från våra studier av binomialtalen vet vi att de går att skriva på flera olika (men ekvivalenta) vis. \par
\begin{cor}
  Catalantalen ges av 
  \begin{equation*}
    \begin{gathered}
      C_n = \begin{pmatrix}2n-3\\n-1\end{pmatrix}+\begin{pmatrix}2n-2\\n\end{pmatrix}-\begin{pmatrix}2n-3\\n\end{pmatrix}-\begin{pmatrix}2n-2\\n+1\end{pmatrix}
    \end{gathered}
  \end{equation*}
\end{cor}\par
\begin{proof}
  Eftersom detta är en ren och skär omskrivning av binomialformen av Catalantalen gäller att hitta tillbaks:
  \begin{equation*}
    \begin{gathered}
      \dfrac{(2n-3)!}{(n-1)!(n-2)!}+\dfrac{(2n-2)!}{n!(n-2)!}-\dfrac{(2n-3)!}{n!(n-3)!}-\dfrac{(2n-2)!}{(n+1)!(n-3)!}\\
      = \dfrac{(2n-3)!}{(n-1)!(n-3)!}\left(\dfrac{1}{n-2}-\dfrac{1}{n}\right)+\dfrac{(2n-2)!}{n!(n-3)!}\left(\dfrac{1}{n-2}-\dfrac{1}{n+1}\right)\\
      =\dfrac{2(2n-3)!}{n!(n-2)!}+\dfrac{3(2n-2)!}{(n+1)!(n-2)!}\\
      =\dfrac{(2n-3)!}{n!(n-2)!}\left(2+\dfrac{3(2n-2)}{n+1}\right)\\
      =\dfrac{(2n-3)!}{n!(n-2)!}\dfrac{4(2n-1)}{n+1}\\
      =\dfrac{(2n-3)!}{(n+1)!(n-2)!}\dfrac{2(2n-2)(2n-1)}{n-1}\\
      =\dfrac{2(2n-1)!}{(n+1)!(n-1)!}=\dfrac{(2n)!}{(n+1)!n(n-1)!} = \dfrac{(2n)!}{(n+1)!n!} = C_n
    \end{gathered}
  \end{equation*}
\end{proof}

\section{Fler saker som räknas av Catalantalen}

Som vi nämnde tidigare är Catalantalen viktiga eftersom de räknar fler saker än bara just Dyck-stigar. I nästa föreläsning kommer vi se ett viktigt exempel. Nu, i slutet på denna, tar vi några mindre exempel.

\begin{example}
    Antalet sätt att skriva $2n$ matchande parenteser räknas av Catalantalen. Med matchande parenteser menar vi alltså ett uttryck som $(()(()))()(())$ -- och i ett uttryck som $)((()$ matchar de inte. Varje $($ måste ha en motsvarande $)$ senare i ordet, och varje $)$ måste ha ett matchande $($ senare i ordet.

    Hur bevisar vi att detta räknas av Catalantalen? Jo, vi ser att detta lyder samma rekursion som Dyck-stigarna gjorde. Varje uttryck med matchande parenteser måste börja med $($, och denna första startparentes måste matcha en slutparentes. Det som står inom dessa parenteser måste också vara ett matchande uttryck, och likaså det som står efter slutparentesen som matchar första parentesen.

    Alltså kan vi skriva varje uttryck med matchande parenteser på formen $(w_1)w_2$, med $w_1$ och $w_2$ två kortare matchande uttryck. Det här är precis samma uppdelning som vi hade för våra Dyckstigar, så det kommer ge samma rekursion, och alltså är det samma följd.\sidenote[][-2cm]{Vi hade också, vilket kanske vore enklare, helt enkelt kunnat se att det finns en bijektion mellan matchande uttryck med parenteser och Dyck-stigar, genom att tolka $($ som ``steg uppåt'' och $)$ som ``steg till höger''.}
\end{example}

\begin{example}\label{example_polygons}
    Det problem som ursprungligen fick upp matematikers intresse i väst\sidenote[][-0.6cm]{De studerades först av en matematiker i Kina på 1700-talet vid namn Minggatu, som använde dem för att ge identiteter för sinus-funktionen, i stil med
    $$\sin(2\alpha) = 2\sin(\alpha) - \sum_{n=1}^{\infty} \frac{C_{n-1}}{4^{n-1}}\sin^{2n+1}(\alpha).$$} för Catalantalen var att dela upp en konvex polygon med $n+2$ sidor i trianglar, genom att rita streck mellan hörnen som inte korsar varandra.

    \begin{figure}
        \centering
        \includegraphics[width = 0.5\textwidth]{graphics/Catalan-Hexagons-example.pdf}
        \caption{Fallet med hexagoner.}
    \end{figure}

    Det här problemet studerades först av Euler\sidenote[][]{Som ju redan har mer än tillräckligt med saker namngivna efter sig, så det är tur att vi inte döpte talen efter honom.}, och beviset att de räknas av Catalantalen utvecklades av Segner, Goldbach, och Lamé. Vår rekursion för Catalantalen brukar kallas för Segnerrekursionen.

    Senare studerades problemet med parentetiseringar av Eugène Charles Catalan, efter vilken talen fick sitt namn på femtiotalet.
\end{example}

\section{Övningar}

\begin{xca}
    Hur många gitterstigar av längd $n$ från $(0,0)$ till $(a,b)$ finns det?
\end{xca}

\begin{xca}
    Bevisa att antalet uppdelningar av en konvex polygon med $n+2$ sidor i trianglar, såsom vi diskuterade i Exempel \ref{example_polygons}, räknas av Catalantalen.\sidenote[][]{Ledtråd: Tänk kombinatoriskt, och se att dessa också lyder vår rekursion.}
\end{xca}

\begin{xca}
  \hspace{1cm}\par
  \begin{enumerate}[label=(\alph*)]
    \item Visa att Catalantalen kan räknas med $\begin{pmatrix}2n\\n\end{pmatrix}-\begin{pmatrix}2n\\n-1\end{pmatrix}$
    \item Visa att $C_{n+1} = \begin{pmatrix}2n\\n\end{pmatrix}-\begin{pmatrix}2n\\n-2\end{pmatrix}$
  \end{enumerate}
\end{xca}

\newpage

\begin{ans}
    Låt beteckna antalet uppdelningar av ett konvext polygon av $n+2$ hörn i trianglar med $p_n$. Vi vill finna en korrelation mellan trianguleringar av konvexa polygoner av $n+2$ hörn och trianguleringar av polygoner av $n-k+1$ respektive $k$ hörn; alltså en korrelation mellan $p_n$, $p_{n-k+1}$ och $p_{k-2}$. Vi definierar $p_0 = 1$ (varför kommer visa sig strax). Detta ger att $k \in \{2, 3, \ldots, n-1\}$\sidenote[][]{Kom ihåg att $k-2$ i $p_{k-2}$ måste vara större än $0$ och likaså $n+1-k$, alltså är $2$ minsta möjliga värde på $k$ och $n-1$ största möjliga värde.}.
    
    Följande resonemang kommer för enkelhetens skull att utföras för ett konvext polygon av $6+2 = 8$ hörn, alltså en oktagon:
    
    \begin{figure}[h]
        \centering
            \begin{tikzpicture}
            \centering
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
        \end{tikzpicture}
    \end{figure}

    \vspace{4mm}
    
    Vi söker därmed en korrelation mellan antalet trianguleringar av oktagoner, $p_6$, och antalet trianguleringar av $(7-k)$-hörningar och $k$-hörningar, alltså $p_{5-k}$ respektive $p_{k-2}$.
    
    Eftersom:

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[scale=0.5mm] at (2, 0) {\&};
            \node[name=S,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (4,0) {};
            
            \draw (P.corner 1) -- (P.corner 6);
            \draw (P.corner 1) -- (P.corner 7);
            \draw (P.corner 1) -- (P.corner 5);
            \draw (P.corner 1) -- (P.corner 4);
            \draw (P.corner 1) -- (P.corner 3);
            
            \draw (S.corner 5) -- (S.corner 2);
            \draw (S.corner 5) -- (S.corner 3);
            \draw (S.corner 5) -- (S.corner 1);
            \draw (S.corner 5) -- (S.corner 8);
            \draw (S.corner 5) -- (S.corner 7);
        \end{tikzpicture}
    \end{center}

    \vspace{2mm}

    \vspace{2mm}
    
    betraktas som olika uppdelningar trots att de är roterade versioner av varandra innebär detta att vi tar hänsyn till orientering. Som riktmärke markerar vi därför en speciell kant i vår oktagon:

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \draw[color=red, line width=0.5mm] (P.corner 5) -- (P.corner 6);
        \end{tikzpicture}
    \end{center}

    Låt också numrera alla hörn:

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[] at ($ (P.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (P.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (P.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (P.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (P.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (P.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (P.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (P.corner 5) + (0, -0.3) $) {8};

            \draw[color=red, line width=0.5mm] (P.corner 5) -- (P.corner 6);
        \end{tikzpicture}
    \end{center}

    \vspace{2mm}

    Valet av $k$ kommer nu att förtydligas. Vi vill nämligen bilda en triangel inuti vår oktagon med den röda sidan som bas. Talet $k$ låter vi symbolisera vilket hörn som ska bli toppen i vår triangel; varför $k \in \{2, 3, \ldots, 7\}$ blir nu tydligare. Vi tar ett exempel där $k = 5$ för att illustrera:

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[] at ($ (P.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (P.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (P.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (P.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (P.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (P.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (P.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (P.corner 5) + (0, -0.3) $) {8};

            \draw[color=red, line width=0.5mm] (P.corner 5) -- (P.corner 6);
            \draw[color=blue] (P.corner 6) -- (P.corner 2);
            \draw[color=blue] (P.corner 5) -- (P.corner 2);
        \end{tikzpicture}
    \end{center}

    Två intressanta fall sker då $k = 2$ respektive då $k = 7$:

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[] at ($ (P.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (P.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (P.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (P.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (P.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (P.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (P.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (P.corner 5) + (0, -0.3) $) {8};

            \node[name=S,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (5,0) {};
            \node[] at ($ (S.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (S.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (S.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (S.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (S.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (S.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (S.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (S.corner 5) + (0, -0.3) $) {8};

            \draw[color=red, line width=0.5mm] (P.corner 5) -- (P.corner 6);
            \draw[color=blue] (P.corner 6) -- (P.corner 7);
            \draw[color=blue] (P.corner 5) -- (P.corner 7);

            \draw[color=red, line width=0.5mm] (S.corner 5) -- (S.corner 6);
            \draw[color=blue] (S.corner 6) -- (S.corner 4);
            \draw[color=blue] (S.corner 5) -- (S.corner 4);
        \end{tikzpicture}
    \end{center}

    Som går att se sammanfaller då en av kanterna i triangeln med en av sidorna i oktagonen, men detta kommer dock visa sig nödvändigt när vi ska räkna antalet indelningar. \\

    Givet ett $k$-värde (tag $5$ igen för enkelhetens skull) kan vi slutföra trianguleringen av oktagonen genom att först triangulera den fyrhörning som bildats till vänster om triangeln med röd bas, och sedan triangulera femhörningen som bildats till höger om denna triangel. Följande är ett exempel på en fullständig triangulering av oktagonen med denna metod där den orangefärgade linjen hör till den vänstra trianguleringen och de lila linjerna hör till den högra trianguleringen:

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[] at ($ (P.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (P.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (P.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (P.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (P.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (P.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (P.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (P.corner 5) + (0, -0.3) $) {8};

            \draw[color=red, line width=0.5mm] (P.corner 5) -- (P.corner 6);
            \draw[color=blue] (P.corner 6) -- (P.corner 2);
            \draw[color=blue] (P.corner 5) -- (P.corner 2);

            \draw[color=orange] (P.corner 5) -- (P.corner 3);
            
            \draw[color=purple] (P.corner 6) -- (P.corner 8);
            \draw[color=purple] (P.corner 2) -- (P.corner 8);
        \end{tikzpicture}
    \end{center}

    Antalet trianguleringar av fyrhörningen och femhörningen ges av $p_2$ respektive $p_3$; det finns därmed $p_2 \cdot p_3$ antal sätt att slutföra oktagonens triangulering för detta $k$-värde. Allmänt gäller att det finns $p_{n - k + 1}$ trianguleringar för den vänstra månghörningen och $p_{k-2}$ för högra månghörningen där $n + 2$ som sagt är antalet hörn i den stora månghörningen\sidenote[][]{Det är av denna anledning vi definierar $p_0 = 1$, för då $k = 2$ eller $k = n + 1$ fås $p_0$ för den högra respektive den vänstra månghörningen; dessa fall motsvarar, som visat ovan, då en av de blå sidorna i triangeln med den röda sidan som bas sammanfaller med en av sidorna hos den stora månghörningen. I dessa fall är den högra respektive vänstra månghörningen en tvåhörning, alltså ett linjesegment, och för att göra dessa fall kompatibla med vår räkning säger vi därför att det finns $1$ sätt att triangulera ett linjesegment trots att den inte innehåller några trianglar.}.
    
    Vi ska nu se att två fullständiga trianguleringar som bildats från olika $k$-värden aldrig kan vara lika. För att se detta placerar vi två oktagoner ovanpå varandra med olika $k$-värden ($k = 5$ och $k = 3$ för sakens skull):

    \begin{center}
        \begin{tikzpicture}
            \node[name=P,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[] at ($ (P.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (P.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (P.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (P.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (P.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (P.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (P.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (P.corner 5) + (0, -0.3) $) {8};

            \node[name=S,regular polygon, regular polygon sides=8, draw, minimum width=3cm] at (0,0) {};
            \node[] at ($ (S.corner 6) + (0, -0.3) $) {1};
            \node[] at ($ (S.corner 7) + (0.2, -0.2) $) {2};
            \node[] at ($ (S.corner 8) + (0.2, 0.2) $) {3};
            \node[] at ($ (S.corner 1) + (0, 0.3) $) {4};
            \node[] at ($ (S.corner 2) + (0, 0.3) $) {5};
            \node[] at ($ (S.corner 3) + (-0.2, 0.2) $) {6};
            \node[] at ($ (S.corner 4) + (-0.2, -0.2) $) {7};
            \node[] at ($ (S.corner 5) + (0, -0.3) $) {8};

            \draw[color=red, line width=0.5mm] (P.corner 5) -- (P.corner 6);
            \draw[color=blue] (P.corner 6) -- (P.corner 2);
            \draw[color=blue] (P.corner 5) -- (P.corner 2);

            \draw[color=red, line width=0.5mm] (S.corner 5) -- (S.corner 6);
            \draw[color=blue] (S.corner 6) -- (S.corner 8);
            \draw[color=blue] (S.corner 5) -- (S.corner 8);
        \end{tikzpicture}
    \end{center}

    Som går att se korsar två av de blå linjerna varandra vilket betyder att dessa trianguleringar måste vara distinkta oavsett hur den vänstra och högra månghörningen trianguleras därefter, för annars skulle det existera en triangulering av oktagonen som inkluderar dessa två korsande linjer vilket vi inte accepterar. Alltså är mängderna av fullständiga trianguleringar givet ett visst $k$ disjunkta. Den enda återstående frågan som måste besvaras innan vi kan dra en slutsats kring antalet trianguleringar av oktagonen är: finns det någon triangulering som \textbf{inte} räknas för något värde på $k$? Det kan det inte göra eftersom en godtycklig triangulering av oktagonen alltid innefattar en triangel som innehåller vår speciella röda sida och som därmed kan delas upp i en vänstra och högra månghörning\sidenote[][]{Kan som sagt vara ett linjesegment på en av sidorna.}. Enligt additionsprincipen ges därmed antalet fullständiga trianguleringar av oktagonen av summan av alla trianguleringar för specifika $k$-värden, alltså:

    \vspace{-2mm}
    
    \begin{align*}
        p_6 = \sum_{k = 2}^{7} p_{k - 2} p_{7 - k}
    \end{align*}

    Resonemanget som vi just utfört gäller allmänt och därmed är antalet trianguleringar av en $(n + 2)$-hörning lika med:

    \vspace{-2mm}
    
    \begin{align*}
        p_{n} = \sum_{k = 2}^{n + 1} p_{k - 2} p_{n - k + 1}
    \end{align*}

    En justering av denna summa ger:

    \vspace{-2mm}
    
    \begin{align*}
        p_{n} = \sum_{k = 0}^{n - 1} p_k p_{n - k - 1}
    \end{align*}

    Alltså följer antalet trianguleringar av månghörningar Catalantalens rekurrensrelation:

    \vspace{-2mm}
    
    \begin{align*}
        p_{n + 1} = \sum_{k = 0}^n p_k p_{n - k}
    \end{align*}

    d.v.s dessa räknas av Catalantalen.

    $\hfill \square$
\end{ans}

\begin{ans}
    Låt $F_n$ vara alla följder av given längd $n \in \mathbb{Z}_{\geq 0}$ som uppfyller villkoren i uppgiften, och låt $|F_n| = f_n$. Låt därefter $(F_n)_k$ beteckna alla följder i $F_n$ vars sista $1$:a är på position nummer $k$ i följden, d.v.s. $(F_n)_k = \{a \in F_n\ : a_k = 1 \land \forall i \in \{k+1, k+2, \ldots, n\}(a_i \neq 1)\}$\sidenote[][]{$k$ är alltså begränsad till att vara ett element av $\{1, 2, \ldots, n\}$}. Låt nu definiera mängden av funktioner:

    \vspace{-3mm}
    
    \begin{align*}
        \mathbb{U}_{n, k} : (F_n)_k \rightarrow F_{n-k} \times F_{k-1}
    \end{align*}

    så att om $a = (a_1, a_2, \ldots, a_n) \in (F_n)_k$\sidenote[][]{Alltså $a_1 = 1$ eftersom $a \in (F_n)_k \subseteq F_n$, och $a_k = 1$ är den sista $1$:an i följden.}:

    \vspace{-3mm}

    \begin{align*}
        \mathbb{U}_{n,k}(a) = \begin{pmatrix} (a_1, a_2, \ldots, a_{k-1}) \\ (a_{k+1} - 1, a_{k+2} - 1, \ldots, a_{n} - 1) \end{pmatrix}
    \end{align*}

    d.v.s. funktionen delar den inmatade följden $a$ vid $a_k$ genom att samla alla komponenter innan $a_k$ i en ny följd av längd $k-1$ samt alla komponenter efter $a_k$ i en ny följd av längd $n-k$. I den andra följden subtraheras också alla komponenter med $1$.

    \vspace{3mm}

    Innan vi kan säga något intressant om denna funktion måste vi första kontrollera att den är väldefinierad. Alltså betrakta ovanstående godtyckliga $a \in (F_n)_k$ som instoppat i $\mathbb{U}_{n, k}$ ger följderna $(a_1, a_2, \ldots, a_{k-1})$ och $(a_{k+1} - 1, a_{k+2} - 1, \ldots, a_{n} - 1)$. Till att börja med så stämmer längderna på dessa följder som sagt överens med $n-k$ och $k + 1$. Den första följden tillhör definitivt $F_{n-k}$ då den bara är en förkortning av $a$ som per definition uppfyller uppgiftens villkor. Eftersom $a_{k+1}, a_{k+2}, \ldots, a_n \geq 2$ då $a_k$ var den sista $1$:an fås $a_{k+1} - 1, a_{k+2} - 1, \ldots, a_n - 1 \geq 1$ och då en förskjutning av alla komponenter med $-1$ inte påverkar det andra villkoret i uppgiften, så länge ingen komponent understiger $1$ efter förskjutningen, så tillhör den andra följden $F_{k-1}$. Därmed är $\mathbb{U}_{n, k}$ väldefinierad.

    \vspace{3mm}
    
    Vi vill nu visa att alla $\mathbb{U}_{n, k}$ är bijektioner. Vi betraktar därför en av funktionerna $\mathbb{U}_{n, k}$ för godtyckligt $k \in \{1, 2, \ldots, n\}$. Vi kan faktiskt visa funktionens surjektivitet och injektivitet på samma gång. För att göra detta betraktar vi ett godtyckligt element i $\alpha \in F_{n-k} \times F_{k-1}$:

    \vspace{-4mm}
    
    \begin{align*}
        \alpha = \begin{pmatrix} (\alpha_1, \alpha_2, \ldots, \alpha_{k-1}) \\ (\alpha_{k+1}, \alpha_{k+2}, \ldots, \alpha_{n}) \end{pmatrix}
    \end{align*}

    Bilda därefter följden av längd $n$ genom att:
    \begin{align*}
        &\text{\textbf{1.} Ta den första följden i $\alpha$.} \\
        &\text{\textbf{2.}  Lägga till $1$ i slutet av denna följd.} \\
        &\text{\textbf{3.}  Ta den andra följden i $\alpha$ och addera $1$ till alla} \\
        &\quad \text{dess komponenter.} \\
        &\text{\textbf{4.}  Lägga till följden från steg 3 i slutet av följden} \\
        &\quad \text{från steg 2.}
    \end{align*}

    Detta ger följden:

    \vspace{-4mm}
    
    \begin{align*}
        \alpha' = (\alpha_1, \alpha_2, \ldots, \alpha_{k-1}, 1, \alpha_{k+1} + 1, \ldots, \alpha_n + 1)
    \end{align*}

    Delföljden $\alpha_1, \ldots, \alpha_{k-1}$ uppfyller per konstruktion uppgiftens villkor, och eftersom att $\alpha_{k+1}, \ldots, \alpha_n$ uppfyller villkoren av samma anledning ger detta att $\alpha_{k+1} + 1, \ldots, \alpha_n + 1$ uppfylla det första villkoret men dock inte det andra som kräver en $1$:a i början av följden då $\alpha_{k+1} = 1 \iff \alpha_{k+1} + 1 = 2$. Men i följden $\alpha'$ har vi lagt till en $1$:a framför $\alpha_{k+1} + 1$ och därmed uppfyller följden $\alpha'$ som helhet alla villkoren för att tillhöra $F_n$. Notera att $\forall i \in \{k+1, k+2, \ldots, n\}(\alpha_i \geq 1) \iff \forall i \in \{k+1, k+2, \ldots, n\}(\alpha_i + 1 \geq 2)$, och därmed är $\alpha' \in (F_n)_k$. Vi kan alltså mata in $\alpha'$ i $\mathbb{U}_{n, k}$ vilket ger:

    \vspace{-4mm}
    
    \begin{align*}
        \mathbb{U}_{n, k}(\alpha') = \begin{pmatrix} (\alpha_1, \alpha_2, \ldots, \alpha_{k-1}) \\ (\alpha_{k+1}, \alpha_{k+2}, \ldots, \alpha_{n}) \end{pmatrix} = \alpha
    \end{align*}

    Detta medför att funktionen $\mathbb{U}_{n ,k}$ är surjektiv. Dessutom så har vi visat att processen när vi bildade $\alpha'$ är inversen till $\mathbb{U}_{n, k}$, och eftersom funktionen har en invers så måste därmed $\mathbb{U}_{n, k}$ vara bijektiv.

    \vspace{3mm}

    Vi vill nu visa att mängderna $(F_n)_k$ är disjunkta för olika värden på $k$. Detta är ekvivalent med att:

    \vspace{-4mm}

    \begin{align*}
        \forall k, \ell \in \{1, 2, \ldots, n\}(k \neq \ell \implies (F_n)_k \cap (F_n)_\ell = \varnothing)
    \end{align*}

    Vi antar negationen:

    \vspace{-4mm}

    \begin{align*}
        &\exists k, \ell \in \{1, 2, \ldots, n\}(k \neq \ell \land (F_n)_k \cap (F_n)_\ell \neq \varnothing) \\
        \implies &\exists k, \ell \in \{1, 2, \ldots, n\}(k \neq \ell \land \exists a \in F_n (a \in (F_n)_k \land a \in (F_n)_\ell))
    \end{align*}

    Alla följder i $(F_n)_k$ har sin sista $1$:a vid position $k$, och alla följder i $(F_n)_\ell$ har sin sista $1$:a vid position $\ell$. Men om det existerar en följd $a$ som ligger i både $(F_n)_k$ och $(F_n)_\ell$ med $k \neq \ell$ så betyder det att denna följd har sin sista $1$:a på två distinkta positioner vilket inte är möjligt. Alltså måste alla mängderna $(F_n)_k$ vara disjunkta för olika värden på $k$.

    \vspace{3mm}

    Nästa steg är att visa att:

    \vspace{-4mm}
    
    \begin{align*}
        &\bigsqcup_{k = 1}^{n} (F_n)_k = F_n \\
        \iff &\bigsqcup_{k = 1}^{n} (F_n)_k \subseteq F_n \\
        \iff &F_n \subseteq \bigsqcup_{k = 1}^{n} (F_n)_k
    \end{align*}

    Den första inklusionen följer mer eller mindre direkt. Antag att:

    \vspace{-4mm}
    
    \begin{align*}
        &a \in \bigsqcup_{k = 1}^{n} (F_n)_k \\
        \implies &\exists \ell \in \{1, \ldots, n\} (a \in (F_n)_\ell) \\
        \iff &\exists \ell \in \{1, \ldots, n\} (a \in F_n \land (a_\ell = 1 \land \forall i \in \{\ell + 1, \ldots, n\} (a_i \neq 1))) \\
        \implies &a \in F_n
    \end{align*}

    För den andra inklusionen antar vi att $a \in F_n$. Nu ställer vi oss frågan: har $a$ har en sista $1$:a? Eftersom $a_1 = 1$ och $a$ är en ändlig följd så följer det att svaret på denna fråga är ja, alltså:

    \vspace{-4mm}

    \begin{align*}
        &\exists \ell \in \{1, \ldots, n\} (a_\ell = 1 \land \forall i \in \{\ell + 1, \ldots, n\})) \\
        \implies &\exists \ell \in \{1, \ldots, n\} (a \in (F_n)_\ell) \\
        \implies &a \in \bigsqcup_{k = 1}^{n} (F_n)_k
    \end{align*}

    Alltså gäller båda inklusionerna och därmed är:

    \vspace{-4mm}
    
    \begin{align*}
        &\bigsqcup_{k = 1}^{n} (F_n)_k = F_n
    \end{align*}

    Vi är nu redo att betrakta $f_n$. Det gäller ju nu nämligen att:

    \vspace{-4mm}

    \begin{align*}
        f_n &= |F_n| \\
        &= |\bigsqcup_{k = 1}^{n} (F_n)_k| \\
        &= \sum_{k=1}^{n} |(F_n)_k| &&\quad \text{(Eftersom mängderna $(F_n)_k$ är disjunkta)} \\
        &= \sum_{k=1}^{n} |F_{n-k} \times F_{k-1}| &&\quad \text{(Använder bijektionerna $\mathbb{U}_{n, k}$)} \\
        &= \sum_{k=1}^{n} |F_{n-k}| \cdot |F_{k-1}| \\
        &= \sum_{k=1}^{n} f_{n-k} \cdot f_{k-1} \\
        &= \sum_{k=0}^{n-1} f_{n-k-1} f_{k} &&\quad \text{(Justering av summa)}
    \end{align*}

    \vspace{3mm}
    
    På mer bekant form innebär detta att för $n \geq 0$:

    \vspace{-4mm}

    \begin{align*}
        f_{n+1} = \sum_{k=0}^{n} f_{n-k} f_{k}
    \end{align*}

    Alltså följer $f_n$ rekurrensrelationen för Catalantalen. Detta ger i sin tur att $f_n$ räknas av Catalantalen.

    $\hfill \square$
\end{ans}

\setcounter{ans}{2}
\begin{ans}
  \begin{enumerate}[label=(\alph*)]
    \item

      \begin{equation*}
        \begin{gathered}
          \dfrac{(2n)!}{n!n!}-\dfrac{(2n)!}{(n+1)!(n-1)!} = \dfrac{(2n)!}{n!(n-1)!}\left(\dfrac{1}{n}-\dfrac{1}{n+1}\right) = \dfrac{(2n)!}{(n+1)!n!} = C_n
        \end{gathered}
      \end{equation*}
      \par\bigskip
    \item 

      \begin{equation*}
        \begin{gathered}
          \dfrac{(2n)!}{n!n!}-\dfrac{(2n)!}{(n+2)!(n-2)!}=\dfrac{(2n)!}{n!(n-2)!}\left(\dfrac{1}{n(n-2)}-\dfrac{1}{(n+1)(n+2)}\right)\\
          = \dfrac{(3n)!}{n!(n-2)!}\left(\dfrac{4n+2}{n(n-1)(n+1)(n+2)}\right)\\
          = \dfrac{2(2n+1)!}{(n+2)!n!} = \dfrac{(2n+2)!}{(n+2)!(n+1)!} = C_{n+1}
        \end{gathered}
      \end{equation*}
  \end{enumerate}
\end{ans}

\subsection{Övning 5}\hfill\\\par
\noindent Vi fick en väldigt bra ledtråd, för att sätta den i perspektiv behöver vi påminna oss om att vi kunde räkna antalet Dyck-stigar med rekursion \textit{och} med Catalan-tal.
\par\bigskip
\noindent Catalan-talen kan alltså skrivas på formen
\begin{equation*}
  \begin{gathered}
    C_0 = 1\qquad C_{n+1} = \sum_{k=0}^{n}C_{k}C_{n-k}
  \end{gathered}
\end{equation*}\par
\noindent Då behöver vi bara hitta ett sätt att räkna partitionerna på liknande vis!
\par\bigskip
\noindent Låt $I(n)$ vara antalet icke-korsande partitioner för $[n]$.\par
\noindent För $I(0)$ (tomma mängden) finns det en mängd som inte korsar andra partitioner, så $I(0) = 1$\par
\noindent Catalan-talens rekursion har en $C_{n-k}$ del där $n$ är fixerad medan $k$ varierar. För $I(n+1)$ blir vi lite kreativa. Vi tittar på den partitionen som innehåller $n+1$, och låter $k$ vara det minsta talet i den partitionen. Vi kan nu partitionera $[n+1]$ i två delar, $[k-1]$ och resten $\left\{k,k+1,\hdots,n+1\right\}$. Partitionen $[k-1]$ har då $I(k-1)$ icke-korsande partitioner. $k$ och $n+1$ är i samma partition per definition, så det finns kvar $I(n+1-k)$ sätt att forma icke-korsande partitioner. Då får vi:
\begin{equation*}
  \begin{gathered}
    I(n+1) = \sum_{k=1}^{n+1}I(k-1)I(n+1-k) = \sum_{j=0}^{n}I(j)I(n-k)
  \end{gathered}
\end{equation*}\par
\noindent Detta är precis Catalan-talen

\bibliography{references}
\bibliographystyle{plainnat}

\end{document}
